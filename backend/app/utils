from app.scrapers.change_org import scrape_change_petitions
from app.scrapers.psc_events import scrape_psc_events
from app.db.supabase_client import insert_action

def run_scrapers_and_insert():
    print("ğŸ” Scraping Change.org...")
    petitions = scrape_change_petitions()

    print("ğŸ” Scraping PSC events...")
    events = scrape_psc_events()

    print("ğŸ“¤ Inserting into Supabase...")
    for item in petitions + events:
        try:
            insert_action(item)
            print(f"âœ… Inserted: {item['title']}")
        except Exception as e:
            print(f"âŒ Failed: {item['title']} â€“ {e}")

if __name__ == "__main__":
    run_scrapers_and_insert()